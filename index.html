<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Chamado Rápido · CAP · FMC</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --green: #3aab85;
    --bg: #090f0c;
    --bg2: #0d1612;
    --text: #e0f5ee;
  }
  * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
  body {
    margin: 0; padding: 0; background-color: var(--bg); color: var(--text);
    font-family: 'Rajdhani', sans-serif;
  }
  .header { padding: 40px 20px 20px; text-align: center; }
  .logo-fmc { font-family: 'Bebas Neue', cursive; font-size: 3rem; color: var(--green); margin: 0; }
  .container { padding: 0 20px 60px; max-width: 480px; margin: 0 auto; }
  .form-card { background: var(--bg2); padding: 30px 25px; border-radius: 24px; border: 1px solid rgba(58,171,133,0.15); }
  
  /* Estilo para esconder a seção da sala */
  #sectionSala { display: block; }
  
  label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.85rem; color: var(--green); text-transform: uppercase; }
  input, select, textarea {
    width: 100%; background: rgba(255,255,255,0.04); border: 1px solid rgba(58,171,133,0.25);
    border-radius: 14px; padding: 14px 16px; color: #fff; font-family: inherit; font-size: 1rem; margin-bottom: 22px;
  }
  .urgencia-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 25px; }
  .urg-btn {
    border: 1px solid rgba(58,171,133,0.2); padding: 12px 5px; border-radius: 12px; text-align: center;
    cursor: pointer; font-weight: 700; font-size: 0.75rem; background: rgba(58,171,133,0.05);
  }
  input[type="radio"]:checked + .urg-btn { background: var(--green); color: var(--bg); }
  .btn-submit {
    width: 100%; background: var(--green); color: var(--bg); border: none; padding: 18px;
    border-radius: 14px; font-family: 'Bebas Neue'; font-size: 1.6rem; cursor: pointer;
  }
  #success { display: none; text-align: center; }
</style>
</head>
<body>

<div class="header">
  <h1 class="logo-fmc">.FMC · CAP</h1>
  <p id="txtInfo" style="font-size: 0.9rem; color: var(--green); font-weight: 600;">SUPORTE TÉCNICO</p>
</div>

<div class="container">
  <div id="formContainer" class="form-card">
    
    <div id="sectionSala">
      <label>Localização (SALA)</label>
      <input type="text" id="salaInput" placeholder="Ex: SALA 201">
    </div>

    <label>O que está acontecendo?</label>
    <select id="catInput">
      <option value="Problema no Projetor">Problema no Projetor</option>
      <option value="Som / Áudio">Som / Áudio</option>
      <option value="Ar Condicionado">Ar Condicionado</option>
      <option value="Computador / Internet">Computador / Internet</option>
      <option value="Outros">Outros</option>
    </select>

    <label>Urgência</label>
    <div class="urgencia-group">
      <label><input type="radio" name="urgencia" value="Baixa" checked style="display:none"><div class="urg-btn">BAIXA</div></label>
      <label><input type="radio" name="urgencia" value="Média" style="display:none"><div class="urg-btn">MÉDIA</div></label>
      <label><input type="radio" name="urgencia" value="Alta" style="display:none"><div class="urg-btn">ALTA</div></label>
    </div>

    <label>Descrição</label>
    <textarea id="descInput" rows="3" placeholder="Detalhes opcionais..."></textarea>

    <label>Seu Nome</label>
    <input type="text" id="nomeInput" placeholder="Seu nome">

    <button class="btn-submit" onclick="enviarChamado()" id="btnTexto">ENVIAR CHAMADO</button>
  </div>

  <div id="success">
    <h2 style="font-family: 'Bebas Neue'; font-size: 3rem; color: var(--green);">ENVIADO!</h2>
    <p>A equipe CAP já foi notificada.</p>
    <button class="btn-submit" onclick="location.reload()" style="background:transparent; border:1px solid var(--green); color:var(--green); margin-top:20px;">VOLTAR</button>
  </div>
</div>

<script>
  // LÓGICA AUTOMÁTICA
  window.onload = function() {
    const urlParams = new URLSearchParams(window.location.search);
    const salaParam = urlParams.get('sala');
    
    if (salaParam) {
      const valorSala = decodeURIComponent(salaParam).toUpperCase();
      document.getElementById('salaInput').value = valorSala;
      
      // ESCONDE O CAMPO para o usuário não precisar ver o que já sabemos
      document.getElementById('sectionSala').style.display = 'none';
      
      // Atualiza o texto do topo para confirmar a sala
      document.getElementById('txtInfo').innerText = "CHAMADO PARA: " + valorSala;
    }
  };

  function enviarChamado() {
    const btn = document.getElementById('btnTexto');
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxId77oG4ZTcRzXth8Xdy_WNoKaDW_Lyer8dBqkohg4yOuOy9bSQWP_VcUh-3ZGW3vn/exec';

    const dados = {
      sala: document.getElementById('salaInput').value,
      categoria: document.getElementById('catInput').value,
      urgencia: document.querySelector('input[name="urgencia"]:checked').value,
      descricao: document.getElementById('descInput').value,
      nome: document.getElementById('nomeInput').value,
      telefone: "Via Web"
    };

    btn.innerText = "ENVIANDO...";
    btn.disabled = true;

    fetch(scriptURL, {
      method: 'POST',
      mode: 'no-cors',
      body: JSON.stringify(dados)
    }).then(() => {
      document.getElementById('formContainer').style.display = 'none';
      document.getElementById('success').style.display = 'block';
    });
  }
</script>
</body>
</html>
